# NST_telegram_bot
1. Выбранная задача перенос стиля(NST)
2. Были изучены предложенные ссылки и статьи. Заинтересовал алгоритм Леона Гатиса в связи с тем что реализация была простой и имелось отличное руководство отличное руководство https://pytorch.org/tutorials/advanced/neural_style_tutorial.html
3. В связи с тем что работа 2015 года, было принято прешение попробоваться использовать в алгоритме более продвинутую CNN нежели VGG19. После некоторых экспериментов было принято решение использовать ResNet50.
4. Создание модели на ResNet. В связи с тем что архитектура ResNet другая, было принято решение менять построение модели, по скольку ResNet50 нельзя было представить как Sequential. В VGG19 использовались только 5 первых сверток, поэтому было принято решение прописать все пути модели в ручную, но к соажлению оказалось что 5ти слоев ResNet слишком мало, в итоге после некоторых экспериментов были полученны хорошие результаты при использовании 13 conv слоев.
5. Тестрирование и сравнение моделей. Оказалось что поведение моделей заметно отличается. Модели на VGG меньше затрагивали текстуру объектов сильнее воздействуя на фон, в тоже время модели на ResNet в равной степени изменяли картинку. Так же стоит отметить что ResNet имея более чем в 2 раза больше слоев работает в 2 раза быстрее VGG.
6. Было принято решение оставить обе модели и дать возможность поэксперементировать пользователю.
7. Борьба с нестабильностью. В некоторых случаях возникала сильная расходимость и
скачки лосов, для борьбы с эти был опробован gradient cliping и использование
шедулера для уменьшения шага оптимизатора при скочках лоса, второе решение было
применено в финальной модели, поскольку меньший шаг оптимизатора
действительно упрощал сходимость модели. Так же много сил был потрачено на
подбор начальной скорости оптимизации и отношения style и content loss.
8. Также были попытки ускорения модели засчёт квантизации, но они оказались
провальны fp16 давала не так много, а int8 не имел градиентов.
9. Была выбрана модель SRGAN для доп части и интегрированна почти в готовом виде
https://github.com/mseitzer/srgan.
10. Для создания бота был выбран telebot, так как достаточно много пособий доступно в интернете для реализации. Было достаточно много проблем и ньюансов в связи с этим они были закрыты не самым оптимальным путем, что в последующем удленило код.
11. Обертка в класс. В представленном решение был создан родительский класс имеющий
методы переноса стиля, а также зашитые сценарии бота, что возможно имелось ввиду
вынести из класса. Затем были написаны классы наследники для различных
конфигураций только vgg / только resnet / оба + super_res.
12. Настройка всех моделей для работы с cpu, опробован хотсинг на различных машинах.
13. Поиск нюансов и ошибок, добавление обработки ошибок в сценариях чатов
